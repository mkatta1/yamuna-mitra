For transactions data sample, go to :
Snowflake --> Data Products --> Marketplace 
--> Search for "UK Row-level Transaction Data - Sample"

For Star schema implementation in detail, go to:
https://blog.devgenius.io/implementing-star-schema-in-snowflake-data-warehouse-1f890cdda952

Instead of raw_credit_debit_transaction--> UK_ROWLEVEL_TRANSACTION_DATA__SAMPLE


ðŸ”· DIM_USERS
DIM_USERS will store usersâ€™ demographic information such as user id, age, salary, gender and address.

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.dim_users AS (
    SELECT
        DISTINCT user_reference AS user_id, 
        age_band, 
        salary_band, 
        postcode,
        LSOA,
        MSOA,
        derived_gender AS gender
    FROM raw_credit_debit_transaction.public_listing.transactions
);

ðŸ”· DIM_ACCOUNTS
DIM_ACCOUNTS stores account level attributes such as account id, bank name and account type

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.dim_accounts AS (
    SELECT
        DISTINCT account_reference AS account_id,
        provider_group_name AS bank_name,
        account_type,
        account_created_date,
        account_last_refreshed
    FROM raw_credit_debit_transaction.public_listing.transactions
);

ðŸ”· DIM_MERCHANTS

All information about the merchants such as merchantâ€™s name and business category will be stored in DIM_MERCHANTS. The dataset does not provide merchant identifier, so in this case I have decided to create a surrogate key for merchantâ€™s key identifier.

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.dim_merchants AS (
    SELECT
        DISTINCT HASH(merchant_name, merchant_business_line)::VARCHAR AS merchant_id,
        merchant_name,
        merchant_business_line
    FROM raw_credit_debit_transaction.public_listing.transactions
);

ðŸ”· DIM_TRANSACTIONS

DIM_TRANSACTIONS stores information on transaction attributes such as transaction type and purpose.

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.dim_transactions AS (
    SELECT
        transaction_reference AS transaction_id,
        credit_debit AS transaction_type,
        auto_purpose_tag_name AS transaction_purpose
    FROM raw_credit_debit_transaction.public_listing.transactions
);

ðŸ”· DIM_DATES

I decided to create a data dimension that stores all date related parsed values such as day of the month, day name, month of the year, month name, etc. This will be handy when we need to generate time based reports.

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.dim_dates AS (
    SELECT
        DISTINCT transaction_date,
        DAY(transaction_date)::VARCHAR as day_of_month,
        DAYNAME(transaction_date) as day_name,
        MONTH(transaction_date)::VARCHAR as month_of_year,
        MONTHNAME(transaction_date) as month_name,
        YEAR(transaction_date)::VARCHAR as year
    FROM raw_credit_debit_transaction.public_listing.transactions
);

4. Identify the facts.

It is quite obvious from both the business process and dataset, that amount information/column is the fact or quantitative measure in the business process.

ðŸ”¶ FCT_TRANSACTIONS

FCT_TRANSACTIONS will store the numeric information (transaction amount) and foreign keys that connect it to the dimension tables. To note, I also add transaction date column as a way to connect the FCT_TRANSACTIONS to DIM_DATES table. A better approach is to use surrogate key to generate date identifier but that is outside the scope of this post.

CREATE OR REPLACE TABLE analytics.marts_credit_debit_transaction.fct_transactions AS (
    SELECT
        transaction_date AS transaction_date,
        transaction_reference AS transaction_id,
        user_reference AS user_id,
        account_reference AS account_id,
        HASH(merchant_name, merchant_business_line)::VARCHAR AS merchant_id,
        amount::NUMBER as amount
    FROM raw_credit_debit_transaction.public_listing.transactions
);



ANOTHER EXAMPLE OF DIMENSIONAL DATA MODEL:

PRODUCT DIMENSION:
Product Dimension Identifier(PK)
Product Category Name
Product Sub-Category Name
Product Name
Product Feature Description
Date Time Stamp

ORGANIZATION DIMENSION:
Organization Dimension Identifier(PK)
Corporate Office Name
Region Name
Branch Name
Employee Name
Date Time Stamp

LOCATION DIMENSION:
Location Dimension Identifier(PK)
Country Name
State Name
County Name
City Name
Date Time Stamp

TIME DIMENSION:
Time Dimension Identifier (PK)
Year Number
Day Of Year
Quarter Number
Month Number
Month Name
Month Day Number
Week Number
Day Of Week
Calendar Date
Date Time Stamp

SALES FACT:
Time Dimension Identifier (PK)
Location Dimension Identifier(PK)
Product Dimension Identifier(PK) 
Organization Dimension Identifier(PK)





















