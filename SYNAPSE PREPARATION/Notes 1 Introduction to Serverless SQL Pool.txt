Introduction to Serverless SQL Pool
- serverless, scaling is done automatically to accommodate query resource requirements
- Applications issue T-SQL commands to control node as a single point of contact
- Control node utilizes Distributed Query Processing (DQP) engine to optimize and orchestrate distributed execution by splitting queries into smaller queries
- small query is called task and represents distributed execution unit
- Compute nodes stores in Azure Storage and runs parallel queries.
- Data Movement Service (DMS) is a system-level internal service that moves data bw Nodes necessary to queries in parallel and return accurate results.


For serverless SQL pool scaling is done automatically, while for dedicated SQL pool one can:

- Grow or shrink compute power, within a dedicated SQL pool, without moving data.
- Pause compute capacity while leaving data intact, so you only pay for storage.
- Resume compute capacity during operational hours.


Serverless SQL pool allows you to query your data lake files, while dedicated SQL pool allows you to query and ingest data from your data lake files. When data is ingested into dedicated SQL pool, the data is sharded into distributions to optimize the performance of the system. You can choose which sharding pattern to use to distribute the data when you define the table. These sharding patterns are supported:

Hash
Round Robin
Replicate

In dedicated SQL pool, distributions map to Compute nodes for processing. As you pay for more compute resources, pool remaps the distributions to the available Compute nodes. The number of compute nodes ranges from 1 to 60, and is determined by the service level

 Each Compute node has a node ID that is visible in system views  sys.pdw_nodes

In serverless SQL pool, each Compute node is assigned task and set of files to execute task on. Task is distributed query execution unit, which is actually part of query user submitted. Automatic scaling is in effect to make sure enough Compute nodes are utilized to execute user query.


When dedicated SQL pool runs a query, the work is divided into 60 smaller queries that run in parallel.Each of the 60 smaller queries runs on one of the data distributions. Each Compute node manages one or more of the 60 distributions. A dedicated SQL pool with maximum compute resources has one distribution per Compute node. A dedicated SQL pool with minimum compute resources has all the distributions on one compute node.





Query multiple files or folders:
Run a T-SQL query over a set of files within a folder or set of folders
SELECT * FROM
OPENROWSET( BULK N'https://myaccount.dfs.core.windows.net/myroot/*/mysubfolder/*.parquet', FORMAT = 'PARQUET' ) as rows




